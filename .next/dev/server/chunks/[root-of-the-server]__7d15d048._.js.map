{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///D:/Fullstacks/timetable2026/Timetable/lib/auth.js"],"sourcesContent":["import bcrypt from \"bcryptjs\";\r\nimport jwt from \"jsonwebtoken\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET;\r\nconst JWT_EXPIRES_IN = process.env.JWT_EXPIRES_IN || \"7d\";\r\n\r\nif (!JWT_SECRET) {\r\n  throw new Error(\"Please define the JWT_SECRET environment variable\");\r\n}\r\n\r\nexport async function hashPassword(password) {\r\n  const salt = await bcrypt.genSalt(10);\r\n  return bcrypt.hash(password, salt);\r\n}\r\n\r\nexport async function verifyPassword(password, passwordHash) {\r\n  return bcrypt.compare(password, passwordHash);\r\n}\r\n\r\nexport function signJwt(payload) {\r\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });\r\n}\r\n\r\nexport function verifyJwt(token) {\r\n  try {\r\n    return jwt.verify(token, JWT_SECRET);\r\n  } catch (err) {\r\n    return null;\r\n  }\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AACzC,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI;AAErD,IAAI,CAAC,YAAY;IACf,MAAM,IAAI,MAAM;AAClB;AAEO,eAAe,aAAa,QAAQ;IACzC,MAAM,OAAO,MAAM,8IAAM,CAAC,OAAO,CAAC;IAClC,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAQ,EAAE,YAAY;IACzD,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,SAAS,QAAQ,OAAO;IAC7B,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAe;AACnE;AAEO,SAAS,UAAU,KAAK;IAC7B,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAO,KAAK;QACZ,OAAO;IACT;AACF"}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///D:/Fullstacks/timetable2026/Timetable/lib/authMiddleware.js"],"sourcesContent":["import { cookies } from \"next/headers\";\r\nimport { verifyJwt } from \"./auth\";\r\n\r\nexport async function getAuthTokenFromCookies() {\r\n  const cookieStore = await cookies();\r\n  const token = cookieStore.get(\"admin_token\");\r\n  return token?.value || null;\r\n}\r\n\r\nexport async function getAuthenticatedAdmin() {\r\n  const token = await getAuthTokenFromCookies();\r\n  if (!token) return null;\r\n  const payload = verifyJwt(token);\r\n  if (!payload || payload.role !== \"admin\") return null;\r\n  return payload;\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC;IAC9B,OAAO,OAAO,SAAS;AACzB;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM;IACpB,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,UAAU,IAAA,0HAAS,EAAC;IAC1B,IAAI,CAAC,WAAW,QAAQ,IAAI,KAAK,SAAS,OAAO;IACjD,OAAO;AACT"}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///D:/Fullstacks/timetable2026/Timetable/app/api/auth/admin/me/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { getAuthenticatedAdmin } from \"../../../../../lib/authMiddleware\";\r\n\r\nexport async function GET() {\r\n  const admin = await getAuthenticatedAdmin();\r\n  if (!admin) {\r\n    return NextResponse.json({ message: \"Unauthorized\" }, { status: 401 });\r\n  }\r\n\r\n  return NextResponse.json(\r\n    {\r\n      admin: {\r\n        id: admin.id,\r\n        email: admin.email,\r\n        role: admin.role,\r\n      },\r\n    },\r\n    { status: 200 }\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM,IAAA,gJAAqB;IACzC,IAAI,CAAC,OAAO;QACV,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAe,GAAG;YAAE,QAAQ;QAAI;IACtE;IAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;QACE,OAAO;YACL,IAAI,MAAM,EAAE;YACZ,OAAO,MAAM,KAAK;YAClB,MAAM,MAAM,IAAI;QAClB;IACF,GACA;QAAE,QAAQ;IAAI;AAElB"}}]
}